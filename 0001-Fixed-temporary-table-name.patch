From 8b59140203d6bc5cb2c877045c896cbd8e65432e Mon Sep 17 00:00:00 2001
From: Juozas Kaziukenas <juozas@juokaz.com>
Date: Mon, 7 Jun 2010 22:10:19 +0100
Subject: [PATCH] Fixed temporary table name

---
 lib/Doctrine/DBAL/Platforms/MsSqlPlatform.php |   24 +++++++++++++++++-------
 1 files changed, 17 insertions(+), 7 deletions(-)

diff --git a/lib/Doctrine/DBAL/Platforms/MsSqlPlatform.php b/lib/Doctrine/DBAL/Platforms/MsSqlPlatform.php
index 2bc57d0..8404ff5 100644
--- a/lib/Doctrine/DBAL/Platforms/MsSqlPlatform.php
+++ b/lib/Doctrine/DBAL/Platforms/MsSqlPlatform.php
@@ -1,7 +1,5 @@
 <?php
 /*
- *  $Id$
- *
  * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
  * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
  * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
@@ -72,7 +70,7 @@ class MsSqlPlatform extends AbstractPlatform
     {
         return false;
     }
-    
+
     /**
      * create a new database
      *
@@ -314,7 +312,7 @@ class MsSqlPlatform extends AbstractPlatform
     {
         return 'SET TRANSACTION ISOLATION LEVEL ' . $this->_getTransactionIsolationLevelSQL($level);
     }
-    
+
     /**
      * @override
      */
@@ -376,7 +374,7 @@ class MsSqlPlatform extends AbstractPlatform
 
         return $unsigned . $autoinc;
     }
-    
+
     /**
      * @override
      */
@@ -401,7 +399,7 @@ class MsSqlPlatform extends AbstractPlatform
     {
         return 'TIME';
     }
-    
+
     /**
      * @override
      */
@@ -522,13 +520,20 @@ class MsSqlPlatform extends AbstractPlatform
      */
     public function getCreateTemporaryTableSnippetSQL()
     {
-        // @todo change to be a real temporary table
         return "CREATE TABLE";
     }
 
     /**
      * @override
      */
+    public function getTemporaryTableName($tableName)
+    {
+        return '#' . $tableName;
+    }
+
+    /**
+     * @override
+     */
     public function getDateTimeFormatString()
     {
         return 'Y-m-d H:i:s.u';
@@ -552,4 +557,9 @@ class MsSqlPlatform extends AbstractPlatform
     {
         return 'mssql';
     }
+
+    protected function initializeDoctrineTypeMappings()
+    {
+
+    }
 }
-- 
1.6.5.1.1367.gcd48

