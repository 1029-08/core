DB_HOST = localhost
DB_PORT = :/tmp/mysql-3307.sock
DB_USER = xlite_demo
DB_PASSWORD =
DB_PARAMS = --port=3307 --socket=/tmp/mysql-3307.sock
DB_DATABASE = xlite_demo
WEBHOST = demo.litecommerce.com
WEBDIR = /
MYSQLPATH = /usr/local/bin

.if exists (config.make)
.include <config.make>
.endif

all:
	@echo "Creating required directories..."
	-mkdir -p -m 777 catalog
	@echo "Unpacking demo images..."
	-tar -zxvf images.tgz
	-rm -rf var
	@echo "Applying permissions..."
	-mkdir -p -m 777 var/run
	-mkdir -p -m 777 var/html
	-chmod 777 var
	-chmod 700 Makefile config.make
	-chmod 644 LICENSE
	-chmod -R 755 compat includes lib classes skins ioncube etc quickstart images *.php *.html
	-rm .htaccess
	@echo "Creating etc/config.local.php..."
	-echo "; <?php /*" > etc/config.local.php
	-echo "[database_details]" >> etc/config.local.php
	-echo "hostspec = \"${DB_HOST}${DB_PORT}\"" >> etc/config.local.php
	-echo "database = \"${DB_DATABASE}\"" >> etc/config.local.php
	-echo "username = \"${DB_USER}\"" >> etc/config.local.php
	-echo "password = \"${DB_PASSWORD}\"" >> etc/config.local.php
	-echo "[host_details]" >> etc/config.local.php
	-echo "http_host = \"${WEBHOST}\"" >> etc/config.local.php
	-echo "https_host = \"${WEBHOST}\"" >> etc/config.local.php
	-echo "web_dir = \"${WEBDIR}\"" >> etc/config.local.php
	-echo "; */ ?>" >> etc/config.local.php
	-chmod 700 restoredb
	-./restoredb demo
